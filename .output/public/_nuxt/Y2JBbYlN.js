import{Y as l,Z as n}from"./CUe4Mrkt.js";function s(r){if(!r)return null;try{const e=r.split(".")[1];if(!e)return null;const t=e.replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(t).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(a)}catch{return null}}const u=l(async r=>{const e=localStorage.getItem("token");if(!e)return n("/login");const t=s(e);if(!t||!t.role)return localStorage.removeItem("token"),n("/login");if(r.path.startsWith("/admin")&&t.role!=="admin")return n("/user");if(r.path.startsWith("/user")&&t.role!=="user")return n("/admin")});export{u as default};
